{% extends 'layouts/main.html' %}
{% block title %}Fyyur | Venues {% endblock %}
{% block content %}
{% for area in areas %}
<h3>{{ area.city }}, {{ area.state }}</h3>
	<ul class="items">
		{% for venue in venues %}
		{% if venue.city == area.city: %}
		<li>
			<a href="/venues/{{ venue.id_venue }}">
				<i class="fas fa-music"></i>
				<div class="item">
					<h5>{{ venue.name }}</h5>
				</div>				
			</a>
		</li>
		<form>
			<input type="submit"
				   value="Delete Venue"
				   class="btn btn-primary btn-lg btn-block"
				   formmethod="POST"
				   formaction="{{ url_for('delete_venue', venue_id=venue.id_venue) }}">
		</form>
		
		<button class="delete-button" data-id="{{ venue.id_venue }}">&cross;</button>
		{% endif %}
		{% endfor %}
	</ul>
{% endfor %}

{% endblock %}

<script>
	        const deleteBtns = document.getElementById('delete-button');
           
            deleteBtns.onclick = function(e) {
            const venue_id = e.target.dataset['id'];
            fetch('/venues/' + venue_id , {
                method: 'DELETE'
			})
			.then(function(){
					windows.location.href = '/venues';
			})
			.catch(function(e){
				console.log('error', e)
			})
        }
    
</script>